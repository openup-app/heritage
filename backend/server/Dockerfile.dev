FROM node:20-alpine3.19

ENV NODE_ENV $NODE_ENV
ENV BASE_URL $BASE_URL

ENV AWS_ACCESS_KEY_ID AWS_ACCESS_KEY_ID
ENV AWS_SECRET_ACCESS_KEY AWS_SECRET_ACCESS_KEY
ENV AWS_REGION AWS_REGION
ENV MEDIA_BUCKET MEDIA_BUCKET
ENV MEDIA_CDN_PREFIX MEDIA_CDN_PREFIX

# Install dependencies in the development image
WORKDIR /srv/server
COPY package*.json ./
RUN npm install

COPY tsconfig.json ./

EXPOSE 8080

CMD npm run dev
